x_val = Scientific_Name,
y_val = avg_root_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = root_length_sd,
titleName = "Average Root Growth",
subtitleName = "per week over 4 weeks",
x_title = "Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
create_bar_plot <- function(data, x_val, y_val, fill_val, sd = NULL, titleName, subtitleName = NULL, x_title, y_title, ...){
colors <- c("experimental" = "#7cb5ec", "control" = "#f7a35c")
chart <- ggplot(data, aes(x = {{x_val}}, y = {{y_val}}, fill = {{fill_val}})) +
geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.6) +
scale_fill_manual(values = colors, name = "") +
labs(title = titleName, subtitle = subtitleName, x = x_title, y = y_title) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 20),
plot.margin = margin(30, 30, 30, 30, "pt"),
plot.background = element_rect(fill = "white"),      # Set plot background color
panel.background = element_rect(fill = "white"))  # Rotate x-axis labels for better readability
if(!missing(sd)){
chart <- chart + geom_errorbar(aes(ymin = {{y_val}} - {{sd}}, ymax = {{y_val}} + {{sd}}), width = 0.4, position = position_dodge(width = 0.8))
}
if(!missing(subtitleName)){
chart <-  chart +
theme(plot.subtitle = element_text(size = 16))
}
fileName <- paste("charts/",titleName,".png")
suppressMessages(ggsave(fileName, chart))
return(chart)
}
create_bar_plot(data = bioData,
x_val = Scientific_Name,
y_val = avg_root_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = root_length_sd,
titleName = "Average Root Growth",
subtitleName = "per week over 4 weeks",
x_title = "Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
create_bar_plot <- function(data, x_val, y_val, fill_val, sd = NULL, titleName, subtitleName = NULL, x_title, y_title, ...){
colors <- c("experimental" = "#7cb5ec", "control" = "#f7a35c")
chart <- ggplot(data, aes(x = {{x_val}}, y = {{y_val}}, fill = {{fill_val}})) +
geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.6) +
scale_fill_manual(values = colors, name = "") +
labs(title = titleName, subtitle = subtitleName, x = x_title, y = y_title) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 20),
plot.margin = margin(30, 30, 30, 30, "pt"),
plot.background = element_rect(fill = "white"),      # Set plot background color
panel.background = element_rect(fill = "white"))  # Rotate x-axis labels for better readability
if(!missing(sd)){
chart <- chart + geom_errorbar(aes(ymin = pmax({{y_val}} - {{sd}}, 0), ymax = {{y_val}} + {{sd}}), width = 0.4, position = position_dodge(width = 0.8))
}
if(!missing(subtitleName)){
chart <-  chart +
plot.subtitle = element_text(size = 16)
}
fileName <- paste("charts/",titleName,".png")
suppressMessages(ggsave(fileName, chart))
return(chart)
}
create_bar_plot(data = bioData,
x_val = Scientific_Name,
y_val = avg_root_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = root_length_sd,
titleName = "Average Root Growth",
subtitleName = "per week over 4 weeks",
x_title = "Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
create_bar_plot <- function(data, x_val, y_val, fill_val, sd = NULL, titleName, subtitleName = NULL, x_title, y_title, ...){
colors <- c("experimental" = "#7cb5ec", "control" = "#f7a35c")
chart <- ggplot(data, aes(x = {{x_val}}, y = {{y_val}}, fill = {{fill_val}})) +
geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.6) +
scale_fill_manual(values = colors, name = "") +
labs(title = titleName, subtitle = subtitleName, x = x_title, y = y_title) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 20),
plot.margin = margin(30, 30, 30, 30, "pt"),
plot.background = element_rect(fill = "white"),      # Set plot background color
panel.background = element_rect(fill = "white"))  # Rotate x-axis labels for better readability
if(!missing(sd)){
chart <- chart + geom_errorbar(aes(ymin = pmax({{y_val}} - {{sd}}, 0), ymax = {{y_val}} + {{sd}}), width = 0.4, position = position_dodge(width = 0.8))
}
if(!missing(subtitleName)){
chart <-  chart + theme(plot.subtitle = element_text(size = 16))
}
fileName <- paste("charts/",titleName,".png")
suppressMessages(ggsave(fileName, chart))
return(chart)
}
create_bar_plot(data = bioData,
x_val = Scientific_Name,
y_val = avg_root_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = root_length_sd,
titleName = "Average Root Growth",
subtitleName = "per week over 4 weeks",
x_title = "Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8)
knitr::opts_chunk$set(warning=FALSE)
#install.packages("dplyr")
#install.packages("tidyr")
#install.packages("ggplot2")
# for data manipulation:
library(dplyr)
library(tidyr)
# for visualization
library(ggplot2)
bioData <- read.csv("rawData.csv")
bioData[is.na(bioData)] <- 0
bioData$Plant.Type <- tolower(bioData$Plant.Type)
bioData$Control.Experimental <- tolower(bioData$Control.Experimental)
bioData$Common.Name <- tolower(bioData$Common.Name)
bioData$Scientific.Name <- tolower(bioData$Scientific.Name)
bioData$Group <- factor(bioData$Group)
bioData$Plant.Type <- factor(bioData$Plant.Type)
bioData$Control.Experimental <- factor(bioData$Control.Experimental)
bioData <- bioData %>%
rename(Common_Name = Common.Name,
Scientific_Name = Scientific.Name,
Plant_Type = Plant.Type,
Controler_Experimental = Control.Experimental,
Root_Count = number.of.roots.over.all,
Sprout_Count = number.of.sprouts.over.all,
Sprout_Week_1_Change_cm = Change.in.week.1..sprout.,
Sprout_Week_2_Change_cm = change.in.week.2..sprout.,
Sprout_Week_3_Change_cm = change.in.week.3..sprout.,
Sprout_Week_4_Change_cm = change.in.week.4..sprout.,
Seed_Amount = seed.amount,
Seed_Amount_Variation = seed.amount.variation..,
Root_Week_1_Change_cm = Change.in.week.1..root.,
Root_Week_2_Change_cm = change.in.week.2..root.,
Root_Week_3_Change_cm = change.in.week.3..root.,
Root_Week_4_Change_cm = change.in.week.4..root.,
Root_Lengths_cm = Indavidual.lengrths..roots.,
Sprout_Lengths_cm = Indavidual.langth..sprouts.
)
bioData <- bioData %>% filter(Root_Lengths_cm != "" | Sprout_Lengths_cm != "")
# remove leading and trailing commas
remove_commas <- function(x) {
gsub("^,|,$", "", x)
}
bioData <- bioData %>%
group_by(Scientific_Name, Controler_Experimental) %>%
summarize(
Common_Name = first(Common_Name),
Root_Lengths_cm = remove_commas(paste(Root_Lengths_cm, collapse = ", ")),
Plant_Type = first(Plant_Type),
Root_Count = sum(Root_Count),
Sprout_Count = sum(Sprout_Count),
Sprout_Week_1_Change_cm = mean(Sprout_Week_1_Change_cm),
Sprout_Week_2_Change_cm = mean(Sprout_Week_2_Change_cm),
Sprout_Week_3_Change_cm = mean(Sprout_Week_3_Change_cm),
Sprout_Week_4_Change_cm = mean(Sprout_Week_4_Change_cm),
Seed_Amount = sum(Seed_Amount),
Seed_Amount_Variation = first(Seed_Amount_Variation),
Root_Week_1_Change_cm = mean(Root_Week_1_Change_cm),
Root_Week_2_Change_cm = mean(Root_Week_2_Change_cm),
Root_Week_3_Change_cm = mean(Root_Week_3_Change_cm),
Root_Week_4_Change_cm = mean(Root_Week_4_Change_cm),
Sprout_Lengths_cm = remove_commas(paste(Sprout_Lengths_cm, collapse = ", "))
) %>%
ungroup()
bioData <- bioData %>% mutate(id = row_number())
bioData <- bioData %>% select(id, everything())
rootLengthsData <- bioData %>% separate_rows(Root_Lengths_cm, sep = ",") %>% select(id, Root_Length_cm = Root_Lengths_cm)
rootLengthsData <- rootLengthsData %>% mutate(Root_Length_cm = as.numeric(Root_Length_cm))
sproutLengthsData <- bioData %>%
separate_rows(Sprout_Lengths_cm, sep = ",") %>%
select(id, Sprout_Length_cm = Sprout_Lengths_cm) %>%
mutate(Sprout_Length_cm = as.numeric(Sprout_Length_cm))
sproutLengthsData[is.na(sproutLengthsData)] <- 0
bioData <- bioData %>% select(-Root_Lengths_cm, -Sprout_Lengths_cm)
calculate_summary <- function(main_data, summary_data, id_col, summary_col, summary_name, summary_method){
summary_values <- summary_data %>%
group_by({{id_col}}) %>%
summarize(
{{summary_name}} := summary_method({{summary_col}})
)
result <- left_join(main_data, summary_values, by = join_by({{id_col}}))
return(result)
}
bioData <- calculate_summary(bioData, rootLengthsData, id, Root_Length_cm, avg_root_length_cm, mean) # average root length
bioData <- calculate_summary(bioData, sproutLengthsData, id, Sprout_Length_cm, avg_sprout_length_cm, mean) # average sprout length
bioData <- calculate_summary(bioData, rootLengthsData, id, Root_Length_cm, median_root_length_cm, median) # Median sprout length
bioData <- calculate_summary(bioData, sproutLengthsData, id, Sprout_Length_cm, median_sprout_length_cm, median) # Median sprout length
bioData <- calculate_summary(bioData, rootLengthsData, id, Root_Length_cm, root_length_sd, sd) # root length standard deviation
bioData <- calculate_summary(bioData, sproutLengthsData, id, Sprout_Length_cm, sprout_length_sd, sd) # sprout length standard deviation
# set all na values to 0
bioData[is.na(bioData)] <- 0
bioData <- cbind(bioData,
avg_root_growth_per_week_cm =
rowSums(bioData %>%
select(Root_Week_1_Change_cm, Root_Week_2_Change_cm, Root_Week_3_Change_cm, Root_Week_4_Change_cm)))
bioData <- cbind(bioData,
avg_sprout_growth_per_week_cm =
rowSums(bioData %>%
select(Sprout_Week_1_Change_cm, Sprout_Week_2_Change_cm, Sprout_Week_3_Change_cm, Sprout_Week_4_Change_cm)))
create_bar_plot <- function(data, x_val, y_val, fill_val, sd = NULL, titleName, subtitleName = NULL, x_title, y_title, ...){
colors <- c("experimental" = "#7cb5ec", "control" = "#f7a35c")
chart <- ggplot(data, aes(x = {{x_val}}, y = {{y_val}}, fill = {{fill_val}})) +
geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.6) +
scale_fill_manual(values = colors, name = "") +
labs(title = titleName, subtitle = subtitleName, x = x_title, y = y_title) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 20),
plot.margin = margin(30, 30, 30, 30, "pt"),
plot.background = element_rect(fill = "white"),      # Set plot background color
panel.background = element_rect(fill = "white"))  # Rotate x-axis labels for better readability
if(!missing(sd)){
chart <- chart + geom_errorbar(aes(ymin = pmax({{y_val}} - {{sd}}, 0), ymax = {{y_val}} + {{sd}}), width = 0.4, position = position_dodge(width = 0.8))
}
if(!missing(subtitleName)){
chart <-  chart + theme(plot.subtitle = element_text(size = 16))
}
fileName <- paste("charts/",titleName,".png")
suppressMessages(ggsave(fileName, chart))
return(chart)
}
create_bar_plot(data = bioData,
x_val = Scientific_Name,
y_val = avg_root_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = root_length_sd,
titleName = "Average Root Growth",
subtitleName = "per week over 4 weeks",
x_title = "Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
create_bar_plot(data = subset(bioData, Plant_Type == "monocot"),
x_val = Scientific_Name,
y_val = avg_root_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = root_length_sd,
titleName = "Average Root Growth for monocot plants",
subtitleName = "per week over 4 weeks",
x_title = "Monocot Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
create_bar_plot(data = subset(bioData, Plant_Type == "dicot"),
x_val = Scientific_Name,
y_val = avg_root_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = root_length_sd,
titleName = "Average Root Growth for dicot plants",
subtitleName = "per week over 4 weeks",
x_title = "Dicot Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
unique_plant_names <- unique(bioData$Scientific_Name)
# Iterate through each unique plant name
for(plant_name in unique_plant_names){
# Generate a chart for the current plant
create_bar_plot(data = filter(bioData, Scientific_Name == plant_name),
x_val = Scientific_Name,
y_val = avg_root_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = root_length_sd,
titleName = paste("Average Root Growth for",plant_name),
subtitleName = "per week over 4 weeks",
x_title = "Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
}
create_bar_plot(data = subset(bioData, Plant_Type == "dicot"),
x_val = Scientific_Name,
y_val = avg_root_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = root_length_sd,
titleName = "Average Root Growth for dicot plants",
subtitleName = "per week over 4 weeks",
x_title = "Dicot Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
create_bar_plot(data = bioData,
x_val = Scientific_Name,
y_val = avg_sprout_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = sprout_length_sd,
titleName = "Average Sprout Growth",
subtitleName = "per week over 4 weeks",
x_title = "Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
# Iterate through each unique plant name
for(plant_name in unique_plant_names){
# Generate a chart for the current plant
create_bar_plot(data = filter(bioData, Scientific_Name == plant_name),
x_val = Scientific_Name,
y_val = avg_sprout_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = sprout_length_sd,
titleName = paste("Average Sprout Growth for",plant_name),
subtitleName = "per week over 4 weeks",
x_title = "Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
}
create_bar_plot(data = subset(bioData, Plant_Type == "monocot"),
x_val = Scientific_Name,
y_val = avg_sprout_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = sprout_length_sd,
titleName = "Average Sprout Growth for monocot plants",
subtitleName = "per week over 4 weeks",
x_title = "Monocot Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
create_bar_plot(data = subset(bioData, Plant_Type == "dicot"),
x_val = Scientific_Name,
y_val = avg_sprout_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = sprout_length_sd,
titleName = "Average Sprout Growth for dicot plants",
subtitleName = "per week over 4 weeks",
x_title = "Dicot Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
better_growth <- bioData %>%
group_by(Scientific_Name) %>%
summarise(
better_growth_control = sum(avg_root_growth_per_week_cm[Controler_Experimental == "control"] > avg_root_growth_per_week_cm[Controler_Experimental == "experimental"]),
better_growth_experimental = sum(avg_root_growth_per_week_cm[Controler_Experimental == "experimental"] > avg_root_growth_per_week_cm[Controler_Experimental == "control"])
) %>%
summarise(
better_growth_control = sum(better_growth_control),
better_growth_experimental = sum(better_growth_experimental)
) %>%
pivot_longer(cols = starts_with("better_growth"), names_to = "Category", values_to = "total_count") %>%
mutate(Category = gsub("better_growth_", "",Category)) %>%
mutate (sd = 0)
chart <- create_bar_plot(data = better_growth,
x_val = Category,
y_val = total_count,
fill_val = Category,
sd = sd,
titleName = "Better Root Growth per Condition",
subtitleName = "",
x_title = "Condition",
y_title = "Number of plants")
chart <- chart + guides(fill = FALSE) + geom_errorbar(aes(ymin = total_count - sd_count, ymax = total_count + sd_count), width = 0.4)
suppressMessages(ggsave("charts/Better Growth per Condition.png", chart))
better_growth <- bioData %>%
group_by(Scientific_Name) %>%
summarise(
better_growth_control = sum(avg_root_growth_per_week_cm[Controler_Experimental == "control"] > avg_root_growth_per_week_cm[Controler_Experimental == "experimental"]),
better_growth_experimental = sum(avg_root_growth_per_week_cm[Controler_Experimental == "experimental"] > avg_root_growth_per_week_cm[Controler_Experimental == "control"])
) %>%
summarise(
better_growth_control = sum(better_growth_control),
better_growth_experimental = sum(better_growth_experimental)
) %>%
pivot_longer(cols = starts_with("better_growth"), names_to = "Category", values_to = "total_count") %>%
mutate(Category = gsub("better_growth_", "",Category)) %>%
mutate (sd = 0)
chart <- create_bar_plot(data = better_growth,
x_val = Category,
y_val = total_count,
fill_val = Category,
titleName = "Better Root Growth per Condition",
subtitleName = "",
x_title = "Condition",
y_title = "Number of plants")
chart <- chart + guides(fill = FALSE) + geom_errorbar(aes(ymin = total_count - sd_count, ymax = total_count + sd_count), width = 0.4)
suppressMessages(ggsave("charts/Better Growth per Condition.png", chart))
better_growth <- bioData %>%
group_by(Scientific_Name) %>%
summarise(
better_growth_control = sum(avg_root_growth_per_week_cm[Controler_Experimental == "control"] > avg_root_growth_per_week_cm[Controler_Experimental == "experimental"]),
better_growth_experimental = sum(avg_root_growth_per_week_cm[Controler_Experimental == "experimental"] > avg_root_growth_per_week_cm[Controler_Experimental == "control"])
) %>%
summarise(
better_growth_control = sum(better_growth_control),
better_growth_experimental = sum(better_growth_experimental)
) %>%
pivot_longer(cols = starts_with("better_growth"), names_to = "Category", values_to = "total_count") %>%
mutate(Category = gsub("better_growth_", "",Category)) %>%
mutate (sd = 0)
chart <- create_bar_plot(data = better_growth,
x_val = Category,
y_val = total_count,
fill_val = Category,
titleName = "Better Root Growth per Condition",
subtitleName = "",
x_title = "Condition",
y_title = "Number of plants")
chart <- chart + guides(fill = FALSE)
suppressMessages(ggsave("charts/Better Growth per Condition.png", chart))
chart
better_growth <- bioData %>%
group_by(Scientific_Name) %>%
summarise(
better_growth_control = sum(avg_root_growth_per_week_cm[Controler_Experimental == "control"] > avg_root_growth_per_week_cm[Controler_Experimental == "experimental"]),
better_growth_experimental = sum(avg_root_growth_per_week_cm[Controler_Experimental == "experimental"] > avg_root_growth_per_week_cm[Controler_Experimental == "control"])
) %>%
summarise(
better_growth_control = sum(better_growth_control),
better_growth_experimental = sum(better_growth_experimental)
) %>%
pivot_longer(cols = starts_with("better_growth"), names_to = "Category", values_to = "total_count") %>%
mutate(Category = gsub("better_growth_", "",Category)) %>%
mutate (sd = 0)
chart <- create_bar_plot(data = better_growth,
x_val = Category,
y_val = total_count,
fill_val = Category,
titleName = "Better Root Growth per Condition",
subtitleName = "",
x_title = "Condition",
y_title = "Number of plants",
legend = FALSE)
#chart <- chart + guides(fill = FALSE)
#suppressMessages(ggsave("charts/Better Growth per Condition.png", chart))
chart
create_bar_plot <- function(data, x_val, y_val, fill_val, sd = NULL, titleName, subtitleName = NULL, x_title, y_title, legend = TRUE, ...){
colors <- c("experimental" = "#7cb5ec", "control" = "#f7a35c")
chart <- ggplot(data, aes(x = {{x_val}}, y = {{y_val}}, fill = {{fill_val}})) +
geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.6) +
scale_fill_manual(values = colors, name = "") +
labs(title = titleName, subtitle = subtitleName, x = x_title, y = y_title) +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(size = 20),
plot.margin = margin(30, 30, 30, 30, "pt"),
plot.background = element_rect(fill = "white"),      # Set plot background color
panel.background = element_rect(fill = "white"))  # Rotate x-axis labels for better readability
if(!missing(sd)){
chart <- chart + geom_errorbar(aes(ymin = pmax({{y_val}} - {{sd}}, 0), ymax = {{y_val}} + {{sd}}), width = 0.4, position = position_dodge(width = 0.8))
}
if(!missing(subtitleName)){
chart <- chart + theme(plot.subtitle = element_text(size = 16))
}
if(legend == FALSE){
chart <- chart + guides(fill = FALSE)
}
fileName <- paste("charts/",titleName,".png")
suppressMessages(ggsave(fileName, chart))
return(chart)
}
better_growth <- bioData %>%
group_by(Scientific_Name) %>%
summarise(
better_growth_control = sum(avg_root_growth_per_week_cm[Controler_Experimental == "control"] > avg_root_growth_per_week_cm[Controler_Experimental == "experimental"]),
better_growth_experimental = sum(avg_root_growth_per_week_cm[Controler_Experimental == "experimental"] > avg_root_growth_per_week_cm[Controler_Experimental == "control"])
) %>%
summarise(
better_growth_control = sum(better_growth_control),
better_growth_experimental = sum(better_growth_experimental)
) %>%
pivot_longer(cols = starts_with("better_growth"), names_to = "Category", values_to = "total_count") %>%
mutate(Category = gsub("better_growth_", "",Category)) %>%
mutate (sd = 0)
chart <- create_bar_plot(data = better_growth,
x_val = Category,
y_val = total_count,
fill_val = Category,
titleName = "Better Root Growth per Condition",
subtitleName = "",
x_title = "Condition",
y_title = "Number of plants",
legend = FALSE)
#chart <- chart + guides(fill = FALSE)
#suppressMessages(ggsave("charts/Better Growth per Condition.png", chart))
chart
create_bar_plot(data = subset(bioData, Plant_Type == "dicot"),
x_val = Scientific_Name,
y_val = avg_sprout_growth_per_week_cm,
fill_val = Controler_Experimental,
sd = sprout_length_sd,
titleName = "Average Sprout Growth for dicot plants",
subtitleName = "per week over 4 weeks",
x_title = "Dicot Plant Species",
y_title = "Weekly Overall Growth Avg (cm)")
better_growth <- bioData %>%
group_by(Scientific_Name) %>%
summarise(
better_growth_control = sum(avg_root_growth_per_week_cm[Controler_Experimental == "control"] > avg_root_growth_per_week_cm[Controler_Experimental == "experimental"]),
better_growth_experimental = sum(avg_root_growth_per_week_cm[Controler_Experimental == "experimental"] > avg_root_growth_per_week_cm[Controler_Experimental == "control"])
) %>%
summarise(
better_growth_control = sum(better_growth_control),
better_growth_experimental = sum(better_growth_experimental)
) %>%
pivot_longer(cols = starts_with("better_growth"), names_to = "Category", values_to = "total_count") %>%
mutate(Category = gsub("better_growth_", "",Category)) %>%
mutate (sd = 0)
chart <- create_bar_plot(data = better_growth,
x_val = Category,
y_val = total_count,
fill_val = Category,
titleName = "Better Root Growth per Condition",
subtitleName = "",
x_title = "Condition",
y_title = "Number of plants",
legend = TRUE)
chart
better_growth <- bioData %>%
group_by(Scientific_Name) %>%
summarise(
better_growth_control = sum(avg_root_growth_per_week_cm[Controler_Experimental == "control"] > avg_root_growth_per_week_cm[Controler_Experimental == "experimental"]),
better_growth_experimental = sum(avg_root_growth_per_week_cm[Controler_Experimental == "experimental"] > avg_root_growth_per_week_cm[Controler_Experimental == "control"])
) %>%
summarise(
better_growth_control = sum(better_growth_control),
better_growth_experimental = sum(better_growth_experimental)
) %>%
pivot_longer(cols = starts_with("better_growth"), names_to = "Category", values_to = "total_count") %>%
mutate(Category = gsub("better_growth_", "",Category)) %>%
mutate (sd = 0)
chart <- create_bar_plot(data = better_growth,
x_val = Category,
y_val = total_count,
fill_val = Category,
titleName = "Better Root Growth per Condition",
subtitleName = "",
x_title = "Condition",
y_title = "Number of plants",
legend = FALSE)
chart
