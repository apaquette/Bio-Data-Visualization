---
title: "Enhancing Scientific Inquiry with R for Data Manipulation and Visualization"
author: "Alexandre Paquette"
contributor: "Olivia Josephine Bain"
professor: "Agnes Maciocha"
date: "`r Sys.Date()`"
output:
  word_document:
    toc: true
    fig_caption: yes
  github_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8)
knitr::opts_chunk$set(warning=FALSE)
```

\newpage

# Introduction

Data visualization is a fundamental tool across a multitude of disciplines, serving as a conduit for conveying complex information in a visually accessible and palatable manner. In scientific research, where the exploration and interpretation of data are paramount, effective visualization techniques play a pivotal role in interpreting patterns, trends, and relationships within datasets. By transforming raw data into intuitive visual representations, researchers can gain deeper insights into their findings and communicate them with clarity and precision. In this report, we walk through the process of producing data visualizations for scientific research, exploring the methodologies and strategies that underline the creation of impactful visual narratives.

## Understanding Scientific Research

Scientific research constitutes a meticulous and systematic pursuit of knowledge, aiming to present phenomena, develop theories, and solve practical problems through rigorous methodologies via experimentation, observation, analysis, and interpretation. Central to this endeavor is the collection and processing of data, which serves as the cornerstone for empirical investigation. However, the mere accumulation of data is insufficient without an effective way to interpret and communicate. Data visualization emerges as a vital tool in this process, enabling researchers to distill complex datasets into intuitive visual representations that facilitate hypothesis confirmation or refutation. By harnessing the power of visualization, researchers can discern patterns, trends, and relationships within data, thereby advancing our understanding of the natural world and informing evidence-based decision-making.

## A Real-world Case Study

The real-world case study at the heart of our visualization endeavor revolves around an investigation into the potential benefits of utilizing a bio-priming agent comprising *Bacillus cereus* and *Pseudomonas alcaligenes* during the germination stage of plant development. The overarching objective of this study is to assess whether the application of this bio-priming agent contributes to the overall health and vigor of plants upon completion of the germination process.

The study aims to demonstrate the efficacy of the biopriming agent in enhancing plant growth, resilience, and productivity by leveraging the natural symbiotic relationship between *Bacillus cereus* and *Pseudomonas alcaligenes*. Through a series of controlled experiments and rigorous data collection protocols, researchers seek to evaluate various physiological parameters, including seed germination rates, seedling vigor, root development, and resistance to environmental stressors.

By employing a multidisciplinary approach that integrates microbiology, plant biology, and agronomy, the study endeavors to shed light on the potential applications of bio-priming techniques in sustainable agriculture practices. The findings from this research hold promise for informing agricultural strategies aimed at optimizing plant health and productivity while minimizing reliance on synthetic inputs and agrochemicals.

This real-world case study serves as the foundation for our exploration of data visualization techniques, providing a concrete context for the application of visual analytics in scientific research and innovation within the agricultural domain.

# Research Question

The focal point of our investigation revolves around a central research question: How do we effectively transform real-world data from scientific studies into meaningful visual representations that facilitate insight and understanding? This inquiry stems from the imperative to distill scientific data into actionable insights, particularly within the context of scientific research.

## Rationale Behind the Study

Our study aims to shed light on the process of taking real-world data from a scientific study, manipulating it to extract meaningful insights, and visualizing these insights for enhanced comprehension. Specifically, our interest lies in exploring the relationship between the application of a PGPB (Plant Growth Promoting Bacteria) consortium as a biopriming agent on the seeds of various plant species and the resulting health and vigor of plants during the germination growth stage of the plant life.

Data visualization serves as a powerful tool in this endeavor, enabling us to visually compare growth parameters and trends between experimental bioprimed seeds and control non-exposed seeds. Through visual representations, we seek to uncover patterns, trends, and correlations within the growth data, providing valuable insights into the efficacy of biopriming with PGPB as a plant growth promoter.

## Methodology

Our methodology revolves around leveraging programming tools, specifically R and relevant libraries, to manipulate and visualize the data obtained from the scientific study. By harnessing the capabilities of R programming and associated libraries, we aim to streamline the data processing and visualization workflows, facilitating efficient analysis and interpretation of the dataset.

The specific libraries and techniques employed will be determined based on the nature of the data and the visualization requirements. However, our methodology will prioritize clarity, accuracy, and reproducibility, ensuring that the visualizations produced effectively communicate the insights derived from the data.

This approach allows us to not only explore the intricacies of data manipulation and visualization within the context of scientific research but also lays the foundation for future research endeavors in data-driven inquiry.

# Data Manipulation

In the pursuit of our research regarding the effective of real-world data into insightful visual representation, the 'Data Manipulation' stage serves as a precursor to the visualization process. We will be leveraging the capabilities of R programming and relevant libraries such as dplyr, tidyr, and readr, in order to prepare our data for visualization. We will load our raw data from a CSV file into a variable, denoted as 'bioData', which will be our foundation for subsequent analysis and visualizations. This step facilitates athe organization and structuring of our dataset, and enables the exploration of key insights and trends within the data.

```{r include=FALSE}
#install.packages("dplyr")
#install.packages("tidyr")
#install.packages("readr")
#install.packages("ggplot2")

```

```{r, results='hide', message=FALSE, warning=FALSE}
# for data manipulation:
library(dplyr)
library(tidyr)
library(readr)

# for visualization
library(ggplot2)
```

The following code loads our raw data into the bioData variable.

```{r}
bioData <- read.csv("rawData.csv")
```

## Data Cleanup

In this section, we will refine and restructure our raw data to prepare it for visualization and analysis.

Our first step involves address missing values by replacing all NA values with 0, ensuring consistency and completeness in our dataset.

```{r}
bioData[is.na(bioData)] <- 0
```

Subsequently, we will standardize the formatting of key columns by converting values to lowercase and categorical data types (factor). This facilitates uniformity and ease of analysis.

```{r}
bioData$Plant.Type <- tolower(bioData$Plant.Type)
bioData$Control.Experimental <- tolower(bioData$Control.Experimental)
bioData$Common.Name <- tolower(bioData$Common.Name)
bioData$Scientific.Name <- tolower(bioData$Scientific.Name)
bioData$Group <- factor(bioData$Group)
bioData$Plant.Type <- factor(bioData$Plant.Type)
bioData$Control.Experimental <- factor(bioData$Control.Experimental)
```

Additionally, we will rename our columns to correct spelling mistakes and maintain a consistent format across our dataset.

```{r}
bioData <- bioData %>%
  rename(Common_Name = Common.Name,
         Scientific_Name = Scientific.Name,
         Plant_Type = Plant.Type,
         Control_Experimental = Control.Experimental,
         Root_Count = number.of.roots.over.all,
         Sprout_Count = number.of.sprouts.over.all,
         Sprout_Week_1_Change_cm = Change.in.week.1..sprout.,
         Sprout_Week_2_Change_cm = change.in.week.2..sprout.,
         Sprout_Week_3_Change_cm = change.in.week.3..sprout.,
         Sprout_Week_4_Change_cm = change.in.week.4..sprout.,
         Seed_Amount = seed.amount,
         Seed_Amount_Variation = seed.amount.variation..,
         Root_Week_1_Change_cm = Change.in.week.1..root.,
         Root_Week_2_Change_cm = change.in.week.2..root.,
         Root_Week_3_Change_cm = change.in.week.3..root.,
         Root_Week_4_Change_cm = change.in.week.4..root.,
         Root_Lengths_cm = Indavidual.lengrths..roots.,
         Sprout_Lengths_cm = Indavidual.langth..sprouts.,
         Healthy_Seed_Count = healthy.seed.count
         )
```

To further streamline the dataset, we remove entries that did not exhibit growth for both sprouts and roots, enhancing the relevance and accuracy of our analysis.

```{r}
bioData <- bioData %>% filter(Healthy_Seed_Count != 0)
```

We consolidate matching plant entries entries by control/experimental groups, simplifying the dataset while retaining essential information.

```{r warning=FALSE}
# remove leading and trailing commas
remove_commas <- function(x) {
  gsub("^,|,$", "", x)
}

bioData <- bioData %>%
  group_by(Scientific_Name, Control_Experimental) %>%
  summarize(
    Common_Name = first(Common_Name),
    Root_Lengths_cm = remove_commas(paste(Root_Lengths_cm, collapse = ", ")),
    Plant_Type = first(Plant_Type),
    Root_Count = sum(Root_Count),
    Sprout_Count = sum(Sprout_Count),
    Sprout_Week_1_Change_cm = mean(Sprout_Week_1_Change_cm),
    Sprout_Week_2_Change_cm = mean(Sprout_Week_2_Change_cm),
    Sprout_Week_3_Change_cm = mean(Sprout_Week_3_Change_cm),
    Sprout_Week_4_Change_cm = mean(Sprout_Week_4_Change_cm),
    Seed_Amount = sum(Seed_Amount),
    Seed_Amount_Variation = first(Seed_Amount_Variation),
    Root_Week_1_Change_cm = mean(Root_Week_1_Change_cm),
    Root_Week_2_Change_cm = mean(Root_Week_2_Change_cm),
    Root_Week_3_Change_cm = mean(Root_Week_3_Change_cm),
    Root_Week_4_Change_cm = mean(Root_Week_4_Change_cm),
    Sprout_Lengths_cm = remove_commas(paste(Sprout_Lengths_cm, collapse = ", ")),
    Healthy_Seed_Count = sum(Healthy_Seed_Count)
  ) %>%
  ungroup()
```

We generate unique identifiers for each entry in the dataset, facilitating tracking of individual data points.

```{r}
bioData <- bioData %>% mutate(id = row_number())
bioData <- bioData %>% select(id, everything())
```

Furthermore, we extract the multiple values from the 'Root Lengths' and 'Sprout Lengths' columns, allowing them to be treated as individual numeric values for future visualization. By converting these values to numeric format, we ensure consistency and accuracy in our dataset.

```{r}
rootLengthsData <- bioData %>% 
  separate_rows(Root_Lengths_cm, sep = ",") %>% 
  select(id, Root_Length_cm = Root_Lengths_cm)

rootLengthsData <- rootLengthsData %>% 
  mutate(Root_Length_cm = as.numeric(Root_Length_cm))
```

```{r}
sproutLengthsData <- bioData %>%
  separate_rows(Sprout_Lengths_cm, sep = ",") %>%
  select(id, Sprout_Length_cm = Sprout_Lengths_cm) %>%
  mutate(Sprout_Length_cm = as.numeric(Sprout_Length_cm))

sproutLengthsData <- sproutLengthsData[complete.cases(sproutLengthsData),]

bioData <- bioData %>% select(-Root_Lengths_cm, -Sprout_Lengths_cm)
```

The extracted root and sprout lengths for each plant are retained in their raw form to preserve the integrity of the data for further investigation.

Additionally, we extract the weekly change readings for both root and sprout growth, consolidating them into separate dataset for analysis.

```{r}
weeklyRootGrowths <- gather(
                      select(bioData, 
                            id, Scientific_Name, Control_Experimental, Common_Name, Plant_Type,
                            "1" = Root_Week_1_Change_cm, 
                            "2" = Root_Week_2_Change_cm, 
                            "3" = Root_Week_3_Change_cm, 
                            "4" = Root_Week_4_Change_cm), 
                      key = "week", 
                      value = "measurement_cm",
                      -id, -Scientific_Name, -Control_Experimental, -Common_Name, -Plant_Type)
weeklyRootGrowths <- weeklyRootGrowths %>% mutate(week = as.numeric(week))

```

```{r}
weeklySproutGrowths <- gather(
                      select(bioData, 
                            id, Scientific_Name, Control_Experimental, Common_Name, Plant_Type,
                            "1" = Sprout_Week_1_Change_cm, 
                            "2" = Sprout_Week_2_Change_cm, 
                            "3" = Sprout_Week_3_Change_cm, 
                            "4" = Sprout_Week_4_Change_cm), 
                      key = "week", 
                      value = "measurement_cm",
                      -id, -Scientific_Name, -Control_Experimental, -Common_Name, -Plant_Type)
weeklySproutGrowths <- weeklySproutGrowths %>% 
  mutate(week = as.numeric(week))


```

These data cleanup steps culminate in the removal of redundant columns from our main dataset.

```{r}
bioData <- bioData %>% select(-Root_Week_1_Change_cm, -Root_Week_2_Change_cm, -Root_Week_3_Change_cm, -Root_Week_4_Change_cm, -Sprout_Week_1_Change_cm, -Sprout_Week_2_Change_cm, -Sprout_Week_3_Change_cm, -Sprout_Week_4_Change_cm)
```

## Derive New Data

In this stage, we will go through the process of extracting new information from our dataset by deriving metrics and indicators. To enhance our understanding of the effect of biopriming on plant growth, we can augment our original dataset with additional columns to calculate key measures such as average and median root and stem lengths. Furthermore, we compute the average growth over time for both root and sprout dimensions. By integrating these derived metrics into our dataset, we enable deeper exploration and interpretation of the data.

### Calculate average and median, and standard deviation

In this section, we introduce a versatile method designed to compute summary statistics on a given dataset and append the results to the main dataset. The function `calculate_summar` takes as input the main dataset (`bioData`) and a summary dataset (`rootLengthsData` or `sproutLengthsData`) depending on the specific calculation required.

```{r}
calculate_summary <- function(main_data, summary_data, id_col, summary_col, summary_name, summary_method){
  summary_values <- summary_data %>%
    group_by({{id_col}}) %>%
    summarize(
      {{summary_name}} := summary_method({{summary_col}})
    )
  
  result <- left_join(main_data, summary_values, by = join_by({{id_col}}))
  return(result)
}
```

With this method, we can compute key metrics such as average, median, and standard deviation for both root and sprout lengths. The function `calculate_summary` facilitates efficient aggregation and integration of summary statistics into our main dataset.

```{r, results='hide'}
bioData <- calculate_summary(bioData, rootLengthsData, id, Root_Length_cm, avg_root_length_cm, mean) # average root length
bioData <- mutate(bioData, avg_root_length_cm = avg_root_length_cm / Healthy_Seed_Count)
bioData <- calculate_summary(bioData, sproutLengthsData, id, Sprout_Length_cm, avg_sprout_length_cm, mean) # average sprout length
bioData <- mutate(bioData, avg_sprout_length_cm = avg_sprout_length_cm / Healthy_Seed_Count)
bioData <- calculate_summary(bioData, rootLengthsData, id, Root_Length_cm, median_root_length_cm, median) # Median sprout length
bioData <- calculate_summary(bioData, sproutLengthsData, id, Sprout_Length_cm, median_sprout_length_cm, median) # Median sprout length
bioData <- calculate_summary(bioData, rootLengthsData, id, Root_Length_cm, root_length_sd, sd) # root length standard deviation
bioData <- mutate(bioData, root_length_sd = root_length_sd / Healthy_Seed_Count)
bioData <- calculate_summary(bioData, sproutLengthsData, id, Sprout_Length_cm, sprout_length_sd, sd) # sprout length standard deviation
bioData <- mutate(bioData, sprout_length_sd = sprout_length_sd / Healthy_Seed_Count)
```

# Data Visualization with R

Using R programming, researchers can unlock new insights, uncover hidden patterns, and communicate their findings with clarity and precision. In this section, we explore how to perform data visualization with R, using the `ggplot2` library. We explore various techniques and methodologies for visualizing our data by leveraging the rich functionality and flexibility offered by R. We will examine visualizations created in Excel and identify limitations that can be overcome by using R and `ggplot2`.

## Old Visualizations (using excel)

## Using Functions in R

This is a re-usable function that generates a bar chart based on parameters supplied.

```{r}
create_bar_plot <- function(data, x_val, y_val, fill_val, sd = NULL, titleName, subtitleName = "", x_title, y_title, legend = TRUE, hideXAxisText = FALSE,...){
  colors <- c("control" = "#7cb5ec", "experimental" = "#f7a35c")
  
  chart <- ggplot(data, aes(x = {{x_val}}, y = {{y_val}}, fill = {{fill_val}})) +
          geom_bar(stat = "identity", position = position_dodge(width = 0.8), width = 0.6) +
            scale_fill_manual(values = colors, name = "") +
            labs(title = titleName, subtitle = subtitleName, x = x_title, y = y_title) +
            theme(axis.text.x = element_text(angle = 45, hjust = 1),
                  plot.title = element_text(size = 20),
                  plot.margin = margin(30, 30, 30, 30, "pt"),
                  plot.background = element_rect(fill = "white"),      # Set plot background color
                  panel.background = element_rect(fill = "white"))  # Rotate x-axis labels for better readability
  
  if(!missing(sd)){
    sd_filter <- !is.null(data[[deparse(substitute(sd))]]) & data[[deparse(substitute(sd))]] > 0
    chart <- chart + geom_errorbar(aes(ymin = pmax({{y_val}} - {{sd}}, 0), 
                                        ymax = {{y_val}} + {{sd}}), 
                                        width = 0.4, 
                                        position = position_dodge(width = 0.8), na.rm = TRUE)
  }
  
  if(!legend){
    chart <- chart + guides(fill = FALSE)
  }
  
  if(hideXAxisText){
    chart <- chart + theme(axis.text.x = element_blank()) + labs(x = "")
  }
  
  fileName <- paste("charts/",titleName,subtitleName,".png")
  suppressMessages(ggsave(fileName, chart))
  return(chart)
}
```

This is a re-usable function that generates a scatter plot chart based on parameters supplied.

```{r}
create_scatter_plot <- function(data, x_val, y_val, fill_val, line_of_best_fit = FALSE, growth_curve = FALSE, titleName, subtitleName = "", x_title, y_title, legend = TRUE, hideXAxisText = FALSE,...){
  colors <- c("experimental" = "#7cb5ec", "control" = "#f7a35c")
  
  fileName <- paste("charts/",titleName,subtitleName)
  
  chart <- ggplot(data, aes(x = {{x_val}}, y = {{y_val}}, color = {{fill_val}})) + 
    geom_point() +
    scale_color_manual(values = colors, name = "") +
    labs(title = titleName, subtitle = subtitleName, x = x_title, y = y_title) +
    theme(plot.title = element_text(size = 20),
          plot.margin = margin(30, 30, 30, 30, "pt"),
          plot.background = element_rect(fill = "white"),      # Set plot background color
          panel.background = element_rect(fill = "white"))  # Rotate x-axis labels for better

  if(line_of_best_fit){
    chart <- chart + 
      geom_smooth(method = "lm", 
                  formula = y ~ x, 
                  se = TRUE,
                  aes(group = Control_Experimental), 
                  stat = "smooth", 
                  fullrange = TRUE)
    fileName <- paste(fileName, "_lobf")
  }

  if(growth_curve){
    chart <- chart + 
        geom_smooth(method = "loess", 
                    formula = y ~ x, 
                    se = FALSE,
                    aes(group = Control_Experimental), 
                    stat = "smooth", 
                    fullrange = TRUE)
    fileName <- paste(fileName, "_gc")
  }
  fileName <- paste(fileName, ".png")
  suppressMessages(ggsave(fileName, chart))

  return(chart)
}
```

This is a re-usable function that calculates the r-squared value of a line of a best fit given a dataset, assuming the line was computer using linear regression.

```{r}
get_r_squared <- function(data, grouping, value, category){
  r_squared <- data %>% 
    group_by(!!sym(grouping)) %>% 
    summarise(rsquared = summary(lm(as.formula(paste0(value, " ~ ", category))))$r.squared)
  return(r_squared)
}
```

## Bar charts with R

For the length average comparison, we have two values we can visualize: root lengths, and sprout lengths. Below we will create a dataset derived from our main bioData datset to visualize our root and sprout length data.

```{r}
bioDataRoot <- bioData %>%
              group_by(Scientific_Name) %>%
              filter(n() == 2) %>%
              filter(all(avg_root_length_cm != 0))
```

```{r}
bioDataSprout <- bioData %>%
              group_by(Scientific_Name) %>%
              filter(n() == 2) %>%
              filter(all(avg_sprout_length_cm != 0))
```

Using our create_bar_plot function from earlier, we are creating a visualization to illustrate the average root length by comparing each control sample to the experimental sample. We are also displaying the standard deviation of each sample if available.

The following code creates the visualization for the average root lengths.

```{r}
create_bar_plot(data = bioDataRoot,
                x_val = Scientific_Name,
                y_val = avg_root_length_cm,
                fill_val = Control_Experimental,
                sd = root_length_sd,
                titleName = "Average Root Length",
                x_title = "Plant Species",
                y_title = "Avg Length (cm)")

```

The following code creates the visualization for the average sprout lengths.

```{r}
create_bar_plot(data = bioDataSprout,
                x_val = Scientific_Name,
                y_val = avg_sprout_length_cm,
                fill_val = Control_Experimental,
                sd = sprout_length_sd,
                titleName = "Average Sprout Length",
                x_title = "Plant Species",
                y_title = "Avg Length (cm)")
```

Next, we want to create visualizations for just monocot and dicot plants. Effectively, we want to filter our selection to just monocot or dicot depending on the visualization. We can do this for both root and sprout lengths.

The following code creates a visualization for the average root lengths for just plants

```{r}
create_bar_plot(data = subset(bioDataRoot, Plant_Type == "monocot"),
                x_val = Scientific_Name,
                y_val = avg_root_length_cm,
                fill_val = Control_Experimental,
                sd = root_length_sd,
                titleName = "Average Root Length",
                subtitleName = "for monocot plants",
                x_title = "Monocot Plant Species",
                y_title = "Avg Length (cm)")
```

The following code creates a visualization for the average root lengths for dicot plants.

```{r}
create_bar_plot(data = subset(bioDataRoot, Plant_Type == "dicot"),
                x_val = Scientific_Name,
                y_val = avg_root_length_cm,
                fill_val = Control_Experimental,
                sd = root_length_sd,
                titleName = "Average Root Length",
                subtitleName = "for dicot plants",
                x_title = "Dicot Plant Species",
                y_title = "Avg Length (cm)")
```

The following code creates a visualization for the average sprout lengths for monocot plants.

```{r}
create_bar_plot(data = subset(bioDataSprout, Plant_Type == "monocot"),
                x_val = Scientific_Name,
                y_val = avg_sprout_length_cm,
                fill_val = Control_Experimental,
                sd = sprout_length_sd,
                titleName = "Average Sprout Length ",
                subtitleName = "for monocot plants",
                x_title = "Monocot Plant Species",
                y_title = "Avg Length (cm)")
```

The following code creates a visualization for the average sprout lengths for dicot plants.

```{r}
create_bar_plot(data = subset(bioDataSprout, Plant_Type == "dicot"),
                x_val = Scientific_Name,
                y_val = avg_sprout_length_cm,
                fill_val = Control_Experimental,
                sd = sprout_length_sd,
                titleName = "Average Sprout Length",
                subtitleName = "for dicot plants",
                x_title = "Dicot Plant Species",
                y_title = "Avg Length (cm)")
```

The following section illustrates how we can leverage R as a programming language and produce multiple visualizations all at once. In this case, we have a total of 15 plants we need to generate visualizations for. Each plant needs a visualization for root and sprout lengths, resulting in nearly 30 visualizations for this aspect of the data alone. By writing a script that iterates through each plant, we can quickly produce these visualizations using our create_bar_plot function.

The following code generates visualizations for each plant in the dataset by iterating through a list of plants, and passing a filtered dataset containing the data for just that plant.

```{r}
unique_plant_names <- unique(bioDataRoot$Scientific_Name)
# Iterate through each unique plant name
for(plant_name in unique_plant_names){
  # Generate a chart for the current plant
  create_bar_plot(data = filter(bioDataRoot, Scientific_Name == plant_name),
                  x_val = Scientific_Name,
                  y_val = avg_root_length_cm,
                  fill_val = Control_Experimental,
                  sd = root_length_sd,
                  titleName = "Average Root Length",
                  subtitleName = paste("for ", plant_name),
                  x_title = "Plant Species",
                  y_title = "Avg Length (cm)",
                  hideXAxisText = TRUE)
}
```

The following code generates visualizations does the same as the previous code chunk, but for average sprout lengths.

```{r}
unique_plant_names <- unique(bioDataSprout$Scientific_Name)
# Iterate through each unique plant name
for(plant_name in unique_plant_names){
  # Generate a chart for the current plant
  create_bar_plot(data = filter(bioDataSprout, Scientific_Name == plant_name),
                  x_val = Scientific_Name,
                  y_val = avg_sprout_length_cm,
                  fill_val = Control_Experimental,
                  sd = sprout_length_sd,
                  titleName = "Average Sprout Length",
                  subtitleName = paste("for ", plant_name),
                  x_title = "Plant Species",
                  y_title = "Avg Length (cm)",
                  hideXAxisText = TRUE)
}
```

Finally, we can display the plant distribution between our control and experimental to show how many resulted in higher averages between the control and experimental.

The following code compares the average root length between control or experimental, and adds them to the sum of either control or experimental. It then passes the resulting dataset to our method to display the information visually.

```{r}
higher_length <- bioDataRoot %>%
  group_by(Scientific_Name) %>% 
  summarise(
    higher_length_control = sum(avg_root_length_cm[Control_Experimental == "control"] > avg_root_length_cm[Control_Experimental == "experimental"]),
    higher_length_experimental = sum(avg_root_length_cm[Control_Experimental == "experimental"] > avg_root_length_cm[Control_Experimental == "control"])
  ) %>%
  summarise(
    higher_length_control = sum(higher_length_control),
    higher_length_experimental = sum(higher_length_experimental)
  ) %>%
  pivot_longer(cols = starts_with("higher_length"), names_to = "Category", values_to = "total_count") %>%
  mutate(Category = gsub("higher_length_", "",Category))

create_bar_plot(data = higher_length,
                x_val = Category,
                y_val = total_count,
                fill_val = Category,
                titleName = "Higher Average Root Length",
                subtitleName = "per Condition",
                x_title = "Plant Species",
                y_title = "Number of plants",
                hideXAxisText = TRUE)
```

The following code does the same thing as the previous chunk, but for sprout length.

```{r}
higher_length <- bioDataSprout %>%
  group_by(Scientific_Name) %>% 
  summarise(
    higher_length_control = sum(avg_sprout_length_cm[Control_Experimental == "experimental"] > avg_sprout_length_cm[Control_Experimental == "control"]),
    higher_length_experimental = sum(avg_sprout_length_cm[Control_Experimental == "control"] > avg_sprout_length_cm[Control_Experimental == "experimental"])
  ) %>%
  summarise(
    higher_length_control = sum(higher_length_control),
    higher_length_experimental = sum(higher_length_experimental)
  ) %>%
  pivot_longer(cols = starts_with("higher_length"), names_to = "Category", values_to = "total_count") %>%
  mutate(Category = gsub("higher_length_", "",Category)) %>%
  mutate (sd = 0)

create_bar_plot(data = higher_length,
                x_val = Category,
                y_val = total_count,
                fill_val = Category,
                titleName = "Higher Average Sprout Length",
                subtitleName = "per Condition",
                x_title = "Plant Species",
                y_title = "Number of plants",
                hideXAxisText = TRUE)
```

## Scatter plots with R

Here we know we have one of our plants in our dataset that doesn't have any corresponding control, so we need to remove it from the dataset.

```{r}
weeklyRootGrowths <- weeklyRootGrowths %>% filter(Scientific_Name != "antirrhinum majus")
weeklySproutGrowths <- weeklySproutGrowths %>% filter(Scientific_Name != "antirrhinum majus")
```

Using our create_scatter_plot function from earlier, we are creating a visualization to illustrate the average root growth by comparing each control sample to the experimental sample. We are also using our get_r_squared method to return the r_squared value of the line of best fit using linear regression.

The following code creates the visualization for the average root growth over 4 weeks, and calculates the r_squared value for the control and experimental. Two visualizations are produced: one with a line of best fit, and one with a growth curve.

```{r}
create_scatter_plot(data = weeklyRootGrowths, 
                    x_val = week, 
                    y_val = measurement_cm, 
                    fill_val = Control_Experimental,
                    line_of_best_fit = TRUE,
                    titleName = "Weekly Root Growth",
                    x_title = "Week", 
                    y_title = "Measurments (cm)")

create_scatter_plot(data = weeklyRootGrowths, 
                    x_val = week, 
                    y_val = measurement_cm, 
                    fill_val = Control_Experimental,
                    growth_curve = TRUE,
                    titleName = "Weekly Root Growth",
                    x_title = "Week", 
                    y_title = "Measurments (cm)")

rsquared_data <- get_r_squared(data = weeklyRootGrowths, grouping = "Control_Experimental", value = "measurement_cm", category = "week") %>% 
                  mutate(Plant = "All Plants", Plant_Section = "root")
```

The following code does the same as the previous chunk, but for sprout growth.

```{r}
create_scatter_plot(data = weeklySproutGrowths, 
                    x_val = week, 
                    y_val = measurement_cm, 
                    fill_val = Control_Experimental,
                    line_of_best_fit = TRUE,
                    titleName = "Weekly Sprout Growth", 
                    x_title = "Week", 
                    y_title = "Measurments (cm)")

create_scatter_plot(data = weeklySproutGrowths, 
                    x_val = week, 
                    y_val = measurement_cm, 
                    fill_val = Control_Experimental,
                    growth_curve = TRUE,
                    titleName = "Weekly Sprout Growth", 
                    x_title = "Week", 
                    y_title = "Measurments (cm)")

rsquared_data <- bind_rows(rsquared_data, 
                           get_r_squared(data = weeklySproutGrowths, grouping = "Control_Experimental", value = "measurement_cm", category = "week") %>%
                             mutate(Plant = "All Plants", Plant_Section = "sprout")
                           )

```

As with our column visualizations, we can leverage R programming to produce multiple visualizations using our pre-defined method.

The following code generates visualizations for each plant in the dataset by iterating through a list of plants, and passing a filtered dataset containing the data for just that plant.

```{r}
unique_plant_names <- unique(weeklyRootGrowths$Scientific_Name)
# Iterate through each unique plant name
for(plant_name in unique_plant_names){
  # Generate a chart for the current plant
  create_scatter_plot(data = filter(weeklyRootGrowths, Scientific_Name == plant_name),
                      x_val = week,
                      y_val = measurement_cm,
                      fill_val = Control_Experimental,
                      line_of_best_fit = TRUE,
                      titleName = "Weekly Root Growth",
                      subtitleName = paste("for ", plant_name),
                      x_title = "Week",
                      y_title = "Measurments (cm)")
  
  create_scatter_plot(data = filter(weeklyRootGrowths, Scientific_Name == plant_name),
                      x_val = week,
                      y_val = measurement_cm,
                      fill_val = Control_Experimental,
                      growth_curve = TRUE,
                      titleName = "Weekly Root Growth",
                      subtitleName = paste("for ", plant_name),
                      x_title = "Week",
                      y_title = "Measurments (cm)")
  rsquared_data <- bind_rows(rsquared_data, 
                           get_r_squared(data = filter(weeklyRootGrowths, Scientific_Name == plant_name), 
                                         grouping = "Control_Experimental", 
                                         value = "measurement_cm", category = "week") %>%
                             mutate(Plant = plant_name, Plant_Section = "root")
                           )
}
```

```{r}
unique_plant_names <- unique(weeklySproutGrowths$Scientific_Name)
# Iterate through each unique plant name
for(plant_name in unique_plant_names){
  # Generate a chart for the current plant
  create_scatter_plot(data = filter(weeklySproutGrowths, Scientific_Name == plant_name),
                      x_val = week,
                      y_val = measurement_cm,
                      fill_val = Control_Experimental,
                      line_of_best_fit = TRUE,
                      titleName = "Weekly Sprout Growth",
                      subtitleName = paste("for ", plant_name),
                      x_title = "Week",
                      y_title = "Measurments (cm)")
  
  create_scatter_plot(data = filter(weeklySproutGrowths, Scientific_Name == plant_name),
                      x_val = week,
                      y_val = measurement_cm,
                      fill_val = Control_Experimental,
                      growth_curve = TRUE,
                      titleName = "Weekly Sprout Growth",
                      subtitleName = paste("for ", plant_name),
                      x_title = "Week",
                      y_title = "Measurments (cm)")
    rsquared_data <- bind_rows(rsquared_data, 
                           get_r_squared(data = filter(weeklySproutGrowths, Scientific_Name == plant_name), 
                                         grouping = "Control_Experimental", 
                                         value = "measurement_cm", category = "week") %>%
                             mutate(Plant = plant_name, Plant_Section = "sprout")
                           )
}
write_csv(rsquared_data, "rsquared_data.csv") # save our rsquared values into a .csv for later use
```

# Conclusion

# Glossary of Terms

Biopriming

:   The process of coating the seed with a plant-growth promoting bacteria consortium comprised of Basillus ceres and pusdomonas

Monocot plant

:   The seeds of these plants typically contain a single embryonic leaf

Dicot plant

:   A plant whose germinating seed contain two embryonic leaves

Embryonic leaf

:   The plant embryo, also known as cotyledon
